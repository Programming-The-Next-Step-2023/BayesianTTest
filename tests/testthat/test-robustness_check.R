library(BayesFactor)
library(BayesianTTest)

test_that("robustness check works", {
  res <- robustness_check(x = sleep$extra[sleep$group == 1],
                   y = sleep$extra[sleep$group == 2],
                   paired = TRUE)

  expect_equal(res,
               structure(list(r = c(0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07,
                                     0.08, 0.09, 0.1, 0.11, 0.12, 0.13, 0.14, 0.15, 0.16, 0.17, 0.18,
                                     0.19, 0.2, 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29,
                                     0.3, 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4,
                                     0.41, 0.42, 0.43, 0.44, 0.45, 0.46, 0.47, 0.48, 0.49, 0.5, 0.51,
                                     0.52, 0.53, 0.54, 0.55, 0.56, 0.57, 0.58, 0.59, 0.6, 0.61, 0.62,
                                     0.63, 0.64, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.71, 0.72, 0.73,
                                     0.74, 0.75, 0.76, 0.77, 0.78, 0.79, 0.8, 0.81, 0.820000000000001,
                                     0.830000000000001, 0.840000000000001, 0.850000000000001, 0.860000000000001,
                                     0.870000000000001, 0.880000000000001, 0.890000000000001, 0.900000000000001,
                                     0.910000000000001, 0.920000000000001, 0.930000000000001, 0.940000000000001,
                                     0.950000000000001, 0.960000000000001, 0.970000000000001, 0.980000000000001,
                                     0.990000000000001, 1, 1.01, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07,
                                     1.08, 1.09, 1.1, 1.11, 1.12, 1.13, 1.14, 1.15, 1.16, 1.17, 1.18,
                                     1.19, 1.2, 1.21, 1.22, 1.23, 1.24, 1.25, 1.26, 1.27, 1.28, 1.29,
                                     1.3, 1.31, 1.32, 1.33, 1.34, 1.35, 1.36, 1.37, 1.38, 1.39, 1.4,
                                     1.41, 1.42, 1.43, 1.44, 1.45, 1.46, 1.47, 1.48, 1.49, 1.5, 1.51,
                                     1.52, 1.53, 1.54, 1.55, 1.56, 1.57, 1.58, 1.59, 1.6, 1.61, 1.62,
                                     1.63, 1.64, 1.65, 1.66, 1.67, 1.68, 1.69, 1.7, 1.71, 1.72, 1.73,
                                     1.74, 1.75, 1.76, 1.77, 1.78, 1.79, 1.8, 1.81, 1.82, 1.83, 1.84,
                                     1.85, 1.86, 1.87, 1.88, 1.89, 1.9, 1.91, 1.92, 1.93, 1.94, 1.95,
                                     1.96, 1.97, 1.98, 1.99, 2), BF = c(1.42665116955772, 1.8476979134503,
                                                                        2.2630190403613, 2.67250640948333, 3.07606427726965, 3.47360866732423,
                                                                        3.8650667599831, 4.25037630658143, 4.62948506332568, 5.00235024673746,
                                                                        5.36893801007768, 5.72922293958715, 6.08318757158234, 6.43082192826691,
                                                                        6.77212307291937, 7.10709468416719, 7.4357466448936, 7.75809465662898,
                                                                        8.07415986149067, 8.38396848667238, 8.68755150322614, 8.98494430042988,
                                                                        9.27618637518029, 9.56132103589103, 9.84039512039302, 10.1134587273431,
                                                                        10.3805649606554, 10.6417696864782, 10.8971313022487, 11.1467105173665,
                                                                        11.3905701450385, 11.6287749048557, 11.8613912356776, 12.0884871184052,
                                                                        12.3101319082406, 12.5263961760388, 12.7373515583705, 12.9430706159259,
                                                                        13.1436266999004, 13.3390938260162, 13.529546555843, 13.7150598850941,
                                                                        13.8957091373472, 14.0715698707784, 14.2427177765596, 14.4092285987597,
                                                                        14.5711780510964, 14.7286417408869, 14.8816950980022, 15.0304133085841,
                                                                        15.1748712532952, 15.3151434498793, 15.4513039998178, 15.5834265388797,
                                                                        15.7115841913671, 15.8358495278688, 15.9562945263417, 16.0729905363476,
                                                                        16.1860082462798, 16.2954176534206, 16.4012880366807, 16.5036879318731,
                                                                        16.6026851093855, 16.6983465541176, 16.7907384475587, 16.8799261518834,
                                                                        16.9659741959525, 17.0489462631081, 17.1289051806591, 17.2059129109573,
                                                                        17.2800305439697, 17.3513182912558, 17.4198354812649, 17.4856405558702,
                                                                        17.5487910680641, 17.6093436807375, 17.6673541664753, 17.7228774083005,
                                                                        17.7759674013022, 17.8266772550891, 17.8750591970091, 17.9211645760827,
                                                                        17.9650438675972, 18.0067466783134, 18.0463217522381, 18.0838169769198,
                                                                        18.1192793902243, 18.1527551875519, 18.1842897294593, 18.21392754965,
                                                                        18.2417123633016, 18.2676870756968, 18.2918937911301, 18.3143738220607,
                                                                        18.3351676984874, 18.3543151775184, 18.3718552531142, 18.3878261659807,
                                                                        18.4022654135927, 18.4152097603276, 18.426695247691, 18.4367572046182,
                                                                        18.445430257834, 18.4527483422566, 18.4587447114316, 18.4634519479828,
                                                                        18.4669019740672, 18.4691260618229, 18.4701548437999, 18.4700183233619,
                                                                        18.4687458850528, 18.4663663049166, 18.4629077607639, 18.4583978423781,
                                                                        18.4528635616532, 18.4463313626588, 18.438827131624, 18.4303762068376,
                                                                        18.4210033884582, 18.4107329482293, 18.3995886390978, 18.3875937047292,
                                                                        18.3747708889182, 18.361142444892, 18.3467301445018, 18.3315552873023,
                                                                        18.3156387095154, 18.2990007928781, 18.2816614733708, 18.2636402498276,
                                                                        18.2449561924246, 18.2256279510469, 18.2056737635345, 18.1851114638037,
                                                                        18.1639584898468, 18.1422318916081, 18.1199483387364, 18.0971241282149,
                                                                        18.0737751918675, 18.049917103743, 18.0255650873769, 18.000734022932,
                                                                        17.9754384542174, 17.949692595588, 17.9235103387245, 17.8969052592942,
                                                                        17.8698906234957, 17.8424793944856, 17.8146842386907, 17.786517532006,
                                                                        17.7579913658788, 17.7291175532817, 17.6999076345747, 17.6703728832578,
                                                                        17.640524311616, 17.6103726762567, 17.5799284835433, 17.5492019949236,
                                                                        17.5182032321559, 17.4869419824349, 17.4554278034166, 17.4236700281464,
                                                                        17.3916777698892, 17.3594599268653, 17.3270251868914, 17.2943820319303,
                                                                        17.2615387425488, 17.2285034022867, 17.1952839019377, 17.1618879437435,
                                                                        17.1283230455031, 17.0945965445985, 17.0607156019377, 17.0266872058176,
                                                                        16.9925181757067, 16.9582151659507, 16.9237846694005, 16.8892330209662,
                                                                        16.8545664010956, 16.819790839182, 16.7849122168995, 16.7499362714687,
                                                                        16.7148685988545, 16.6797146568955, 16.6444797683687, 16.6091691239881,
                                                                        16.5737877853412, 16.5383406877618, 16.5028326431429, 16.467268342689,
                                                                        16.4316523596103, 16.3959891517584, 16.3602830642067, 16.3245383317745,
                                                                        16.288759081498, 16.2529493350466, 16.2171130110893, 16.1812539276079,
                                                                        16.1453758041616, 16.1094822641028)), row.names = c(NA, -200L
                                                                        ), class = "data.frame"))
})
